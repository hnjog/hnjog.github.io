---
title: "Chap1_컴퓨터시스템으로의 여행"
last_modified_at: "2023-10-19T17:00:00"
categories:
  - CSAPP
tags:
  - CSAPP
  - CS
---

## 1.5 캐시가 중요하다!
 시스템은 '정보'를 이동시키는 일에<br>
 _많~~은_ 시간을 사용한다<br>
 hello 프로그램은 하드 디스크에 저장되어 있었으며,<br>
 프로그램이 로딩될 때, '메인 메모리'에 <b>복사</b>된다<br><br>
 프로세서가 프로그램을 실행할 때,<br>
 '인스트럭션'들은 '메인 메모리' 에서<br>
 '프로세서'로 복사된다<br>
 또한 "Hello,World!"라는 데이터 스트링도<br>
 디스크 -> 메인 메모리 -> 프로세서<br>
 의 순서로 복사된다!<br><br>

 프로그래머의 관점에서 이는 '작업 속도'를<br> 떨어뜨리는 오버헤드이다.

  - 오버헤드 : 특정 목표를 실행하기 위해<br>
  사용되는 추가적인<br> 시간,메모리, 리소스, 비용 등을 얘기한다<br>
  성능에 직접적인 영향을 끼치기에<br>
  '성능저하'를 의미하기도 한다

 따라서 시스템 설계자의 주 목적은 <br>
 이러한 '복사과정'을 최대한 빠르게 동작하게<br>
 만드는 것!

 물리학의 법칙으로 더 '큰 저장장치'들은<br> '작은 저장장치'보다 느린 속도를 가지며,<br>
 더 많은 용량을 저장 가능하며,<br>
 더 저렴하다<br>

 그렇기에 '메인 메모리'를 빠르게 하는 것보다<br>
 '프로세서'를 더욱 빠르게 만드는 것이<br>
 더 쉬우며, 더 저렴하다<br>
 
 이러한 프로세서 - 메모리 격차에<br>
 대응하기 위하여 시스템 설계자는 보다<br>
 작고 빠른 <b>'캐시 메모리'</b>라는<br>
 저장장치를 고안하여,<br>
 프로세서가 '단기간에 필요로 할 가능성이<br> 높은 정보'를 임시저장할 목적으로 사용한다<br><br>

 가장 빠른 L1 캐시부터,<br>
 L2...L3... 로 숫자가 내려갈 때마다<br>
 속도는 낮아지고, 저장 용량은 늘어난다<br>
 이들은 SLAM(static Random Access Memory)<br>
 기술로 구현한다.<br><br>

 캐시는 '지역성'을 활용하여,<br>
 시스템이 마치 크고 많은 메모리를 활용하는 것과<br>
 동일한 효과를 주게 할 수 있다

  - 지역성<br>
  : 프로그램은 '모든' 코드나 데이터를 <br>'균등'하게       Access 하지 않는다<br>
  '어느 한 순간'에 '특정 영역'을 집중적으로 참조한다

  - 지역성의 종류<br>
  시간적 지역성(Temporal Locality)<br>
  : 최근에 참조된 주소의 내용은 곧 다음에 다시 참조된다<br>
  => 메모리 상의 같은 주소에 여러 차례 읽기/쓰기 수행 시,<br>
    상대적으로 '작은 크기'의 캐시를 사용해도 효율적이다
     
    공간적 지역성(Spatial Locality)<br>
    : 공간적 지역성은 기억장치 내에 서로 인접하여<br>
    저장되어 있는 데이터들이 연속적으로 Access 될<br> 가능성이 높아진다는 특성이다.<br>
    => CPU 캐시나 디스크 캐시의 경우, 한 메모리 주소에<br>
    접근할 때, 그 주소뿐 아니라 해당 블록 전부 캐시에 가져온다<br><br>
    이 때, 메모리 주소를 '오름차순'/ '내림차순'으로<br>
    접급한다면 캐시에 이미 저장된 같은 블록의 데이터를 접근!<br>
    => 효율성 상승!!


  - 캐시 용어<br>
    <b>캐시 적중(Cache Hit)</b><br>
    : CPU가 액세스하려는 데이터가 이미 캐시에 적재되어 있음<br><br>
    <b>캐시 미스(Cache Miss)</b><br>
    : CPU가 액세스하려는 데이터가 캐시에 없어 메인 메모리로부터 인출해야 함<br><br>
    <b>캐시 적중률(Cache Hit Rate)</b><br>
    : CPU가 원하는 데이터가 캐시에 있을 확률<br>
    (캐시에 적중되는 횟수 / 전체 기억장치 액세스 수)<br><br>
    <b>미스율(Miss Rate)</b><br>
    : CPU가 원하는 데이터가 캐시에 없을 확률<br>(1 - 캐시 적중률)<br><br>


## 1.6 저장장치들은 계층구조를 이룬다
  작고 빠른 저장장치(ex : 캐시 메모리)를<br>
  프로세서와 좀 더 크고 느린 장치(ex : 메인 메모라)<br>
  사이에 끼워 넣는 '개념' 이 일반적인 아이디어로 판명되었다<br>

  이러한 주요 아이디어의 '개념'은<br>
  한 level의 저장장치가 다음 하위레벨 저장장치의<br>
  '캐시' 역할을 한다는 것이다<br><br>

  * 로컬 디스크는 '원격 네트워크'에서 파일을 가져와<br>
  미리 보관함으로서, 네트워크의 '캐시' 역할이 가능하다

# 1.7 운영체제는 하드웨어를 관리한다
  한 가지 주목할 점은<br>
  쉘 프로그램이 'Hello' 프로그램을 로드하고<br>
  실행했을 때, 프로그램이 '키보드','디스플레이','디스크',<br>'메인 메모리'를 직접 엑세스 하지 않는다는 점이다<br><br>

  오히려 운영체제(Operation System, OS)의 서비스를<br>
  제공받아 활용한다<br>

  이에 따라서, 운영체제는 '하드웨어'와 '소프트웨어' 사이에<br>
  존재한 계층으로 생각할 수 있다<br>
  => 고로, 응용프로그램(Application)이 하드웨어를<br>
  제어하려면 언제나 운영체제를 거쳐야 한다

  - 운영체제의 2가지 목적
  1. 제멋대로 동작하는 응용프로그램이<br>
     하드웨어를 잘못 사용하는 걸 막기 위함
  2. 응용프로그램이 단순하고 균일한 매커니즘으로<br>
     복잡하고 서로 다른 저수준 하드웨어를 조작할 수 있도록

  운영체제는 이러한 목표를 '추상화'를 통해<br>
  달성하고 있다<br>

  _<b> 프로세스 , 가상메모리, 파일</b>_<br>

  파일 : '입출력장치' 의 추상화<br>
  가상메모리  : '메인 메모리' 와 '입출력장치'의 추상화<br>
  프로세스 : '프로세서','메인 메모리', '입출력장치'의 추상화

## 1.7.1 프로세스
  프로그램이 실행될 때, 마치 프로그램이<br>
  '프로세서','메인 메모리', '입출력장치'를 독차지하는<br>
  것처럼 느껴진다<br>
  => '프로세스' 개념의 결과물!<br>

  프로세스는 실행 중인 '프로그램'에 대한<br>
  '운영체제'의 '추상화'이다<br>

  다수의 '프로세스'들은 동일한 시스템에서<br>
  동시에 실행될 수 있고,<br>
  각 프로세스는 하드웨어를 배타적으로 사용하는 것처럼
  느낀다.<br><br>

  '프로세서'가 '프로세스'들을 바꿔주는 방식으로<br>
  하나의 CPU가 다수의 프로세스를 동시에 실행하는것처럼 보이게 해준다<br><br>

  운영체제는 '문맥 전환'_(Context Switching)_ <br>
  이라는 방법으로 교차수행을 실행한다<br><br>

  운영체제는 프로세스가 실행하는데 필요한 모든<br>
  상태정보의 변화를 추적한다<br>
  '컨택스트'라고 부르는 이 상태정보는<br>
  PC(program Counter), 레지스터 파일, 메인 메모리의<br>
  현재 값을 포함한다<br><br>
  이 값을 사용하여, 운영체제는 다른 프로세스로 제어를<br>
  옮길 때, 현재 프로세스의 컨택스트를 '저장'하고<br>
  새 프로세스의 컨택스트를 '복원'시키는 문맥전환을<br>
  실행한 뒤, 제어권을 새 프로세스에 넘긴다<br>

## 1.7.2 쓰레드(Thread)
  프로세스는 최근의 시스템에서는 쓰레드(thread)라는<br>
  다수의 실행 유닛으로 구성되어 있다<br>

  각각의 쓰레드는 해당 프로세스의 컨택스트에서 실행되며<br>
  동일한 '코드'와 '전역 데이터'를 공유한다<br>

  최근 '프로그래밍 모델'로서의 중요성이 점점 증가하는데,<br>
    - 다수의 프로세스들에서보다 데이터 공유가 더 쉽고<br>
    - 쓰레드가 프로세스보다 더 효율적 이라는 점이다<br>

## 1.7.3 가상 메모리
  가상 메모리는 '각 프로세스' 들이<br>
  '메인 메모리 전체를 독점하여 사용하는 듯'한<br>
  착각을 주는 추상화이다<br>

  프로세는 '가장주소 공간'이라는 균일적 메모리의<br>
  모습을 가지게 된다<br>

  - 프로그램 코드와 데이터 영역
  - 힙 영역 (Runtime Heap) : malloc / free
  - 공유 라이브러리
  - 스택 : 함수 호출
  - 커널 가상메모리 : 커널을 위한 공간

  - 운영체제 '메모리 관리 시스템'의 핵심 부분

  이러한 방식이 동작하기 위해서,<br>
  프로세서가 만들어내는 모든 주소를<br>
  '하드웨어'로 번역하는 등<br>
  하드웨어와 운영체제 소프트웨어 간의<br>
  복잡한 상호작용이 필요하다

## 1.7.4 파일
  파일은 '그저 연속된 바이트들'이다<br>
  디스크, 키보드, 디스플레이,네트워크 까지<br>
  모든 '입출력장치'는 파일로 모델링한다<br>

  응용프로그램에 시스템에 들어 있는 다양한<br>
  입출력장치들의 '통일된 관점'을 제공한다<br>
  (프로그래머는 '어떠한' 하드웨어에서<br>
  사용하는 '특정한' 기술을 알지 않아도 된다!)

## 1.8 시스템은 '네트워크'를 사용하여 다른 시스템과 통신한다
  
