---
title: "Socket"
last_modified_at: "2023-11-17T11:00:00"
categories:
  - 크래프톤 정글
  - CS
  - 네트워크
tags:
  - 크래프톤 정글
  - CS
  - 네트워크
  - 소켓
---

## 포트(port)
 - 하드웨어적 의미 <br>
   : Application Layer에서 데이터를 주고 받고 싶을때,<br>
     프로세스가 하위 계층과 연결을 해주는 장치가 필요함<br>
     이러한 데이터의 통로 역할을 하는 장치가<br>
     바로 '포트'<br>
     (프로세스와 연결된 데이터 통로 혹은 데이터 채널)<br>

 - 네트워크적 의미<br>
   : 인터넷 상에서 위의 port를 유니크하게 식별하기 위하여,<br>
     port (number)를 정의함<br>
     (ex : 포트 80번)<br>
     이는 16비트로 이루어진 숫자(0~65535)<br>
     웹에서 port number를 port로 부르기도 한다<br>

     port number 만으로는 유니크하게 식별할 수 없기에<br>
     다른 추가적인 무언가를 사용해야 함<br>
     => internet address로 각 host를 유니크하게 식별 가능<br>
        (현재는 IP 주소의 의미)<br>

     Internet address + port number를 통해<br>
     인터넷 상의 port를 유니크하게 식별할 수 있다<br>
     => 실제로 이 두 개념을 합친 것이 밑의 socket!

## 소켓(Socket)
 인터넷 상에 존재하는 각 port를 유니크하게 식별하기 위한 주소<br>
 (일종의 namespace)<br>

 따라서 각 socket은 인터넷 상에서 '유니크'하다<br>
 또한 socket은 각 호스트를 대표하므로, '끝'의 노드에 위치해 있음<br>
 
 한 쌍의 socket은 Connection(안정적이고 논리적인 데이터 통로)을<br>
 유니크하게 식별 가능<br>
 (Connection을 요청한 쪽이 src socket, 받는 쪽이 dest socket)<br>

 소켓을 구조체로 구현하는 경우 들어가는 정보들<br>
  - 파일 디스크립터(File Descriptor)<br>
    : 네트워크 소켓을 식별하기 위한 번호, 운영체제에서 관리 (정숫값)<br>
  - 소켓 유형(socket type)<br>
    : 소켓의 종류를 나타내는 정보로, stream socket(TCP)인지,<br>
      datagram socket(UDP)인지를 나타낸다<br>
  - 프로토콜 및 주소 패밀리(protocol and Address Family)<br>
    : 소켓이 사용하는 프로토콜과 주소 패밀리에 대한 정보를 담는다<br>
      프로토콜은 TCP(IPPROTO_TCP) 혹은 UDP(IPPROTO_UDP),<br>
      주소 패밀리는 IPv4(AF_INET) 혹은 IPv6(AF_INET6)를 사용<br>
  - 로컬 및 원격 주소(Local and Remote Address)<br>
    : 소켓의 로컬 주소와 연결된 원격 주소 정보를 담음<br>
      'struct sockaddr' 이나 기타 구조체가 사용됨<br>
  - 상태정보(Status Information)<br>
    : 소켓의 현재 상태를 나타내는 정보로, 연결된지 여부,<br>
      송수신된 데이터 양 등의 정보가 포함 가능<br>
  - 그외 '타임아웃 설정' 등이 사용될 수 있음<br>

## 소켓 인터페이스
 네트워크를 통해 데이터를 주고 받기 위한 일종의 프로그래밍 인터페이스로<br>
 소켓 구조체들을 다루기 위한 함수들을 제공함<br>

 - socket()<br>
  : 소켓을 생성하는 함수, 프로토콜과 소켓 타입을 지정하여 소켓을 만듦<br>
   주소 패밀리 와 소켓 타입 을 설정할 수 있음<br>
 - bind()<br>
  : 소켓에 IP주소와 포트 번호를 할당하는 함수로,<br>
    소켓에 특정 주소를 바인딩함<br>
    (서버에서 주로 사용)<br>
 - listen()<br>
  : 연결 요청을 받기 위해 소켓을 수동 대기 상태로 변경하는 함수<br>
    주로 서버에서 사용되며, 'accept()'호출을 기다림<br>
    이 때, '듣기 식별자'가 생성<br>
 - accept()<br>
  : 클라이언트의 연결 요청을 받아들이고,<br>
    연결된 새로운 소켓을 생성하는 함수<br>
    주로 서버에서 사용되며, 클라이언트와 통신을 담당하는 새로운 소켓을 반환<br>
 - connect()<br>
  : 클라이언트가 서버에 연결하기 위해 호출하는 함수<br>
    소켓을 특정 서버 주소와 포트에 연결<br>
    이 때, '연결 식별자'가 생성<br>
 - send()와 recv() <br>
  : 데이터를 송신하거나 수신하는 함수<br>
 - close()<br>
  : 소켓을 닫는 함수<br>
    사용이 끝난 소켓을 닫아 자원 해제<br>
  
    - 듣기 식별자? 연결 식별자?<br>
      : 듣기 식별자는 '클라이언트 연결 요청'을 위해 생성되며<br>
        서버가 살아있는 동안 계속 존재한다<br>
        연결 식별자는 '클라이언트와 서버의 연결'을 위해 생성되며<br>
        서버가 연결 요청을 '수락'할때마다 생성되고<br>
        서버가 클라이언트에 서비스 하는 동안만 존재한다<br>
        (이러한 식별자 구분은 여러 클라이언트가 서버에 접속할 때 유용하다 한다)<br>

